<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîê Secure LAN Chat - Cryptographie E2E</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="logo">üîê Secure LAN Chat</h1>
                <div class="tech-badge">AES-256-GCM + ECDH</div>
            </div>
            <div class="status-bar" id="statusBar">
                <span class="status-indicator" id="statusIndicator"></span>
                <span class="status-text" id="statusText">Non connect√©</span>
            </div>
        </header>

        <!-- Connection Panel -->
        <div class="connection-panel" id="connectionPanel">
            <div class="panel-header">
                <h2>Configuration de la Connexion</h2>
                <p class="subtitle">Choisissez votre mode de connexion s√©curis√©e</p>
            </div>
            
            <div class="mode-selector">
                <button class="mode-btn active" id="serverModeBtn" onclick="selectMode('server')">
                    <span class="mode-icon">üñ•Ô∏è</span>
                    <span class="mode-title">Mode Serveur</span>
                    <span class="mode-desc">Attendre une connexion</span>
                </button>
                <button class="mode-btn" id="clientModeBtn" onclick="selectMode('client')">
                    <span class="mode-icon">üì°</span>
                    <span class="mode-title">Mode Client</span>
                    <span class="mode-desc">Se connecter √† un pair</span>
                </button>
            </div>

            <div class="connection-forms">
                <!-- Server Form -->
                <div class="connection-form" id="serverForm">
                    <div class="form-group">
                        <label for="serverPort">Port d'√©coute</label>
                        <input type="number" id="serverPort" value="9999" min="1024" max="65535">
                    </div>
                    <button class="btn btn-primary" onclick="startServer()">
                        <span>‚ñ∂Ô∏è D√©marrer le Serveur</span>
                    </button>
                </div>

                <!-- Client Form -->
                <div class="connection-form hidden" id="clientForm">
                    <div class="form-group">
                        <label for="peerIp">Adresse IP du Pair</label>
                        <input type="text" id="peerIp" placeholder="192.168.1.100">
                    </div>
                    <div class="form-group">
                        <label for="peerPort">Port</label>
                        <input type="number" id="peerPort" value="9999" min="1024" max="65535">
                    </div>
                    <button class="btn btn-primary" onclick="connectToPeer()">
                        <span>üîó Se Connecter</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Security Info (shown after handshake) -->
        <div class="security-panel hidden" id="securityPanel">
            <div class="security-header">
                <span class="security-icon">‚úÖ</span>
                <h3>Connexion S√©curis√©e √âtablie</h3>
            </div>
            <div class="fingerprint-box">
                <label>SAS Fingerprint (√† v√©rifier vocalement)</label>
                <div class="fingerprint" id="fingerprint">---- ----</div>
                <p class="fingerprint-note">‚ö†Ô∏è V√©rifiez que ce code correspond √† celui affich√© chez votre correspondant pour garantir l'absence de Man-in-the-Middle.</p>
            </div>
        </div>

        <!-- Chat Area -->
        <div class="chat-container hidden" id="chatContainer">
            <div class="messages" id="messages">
                <!-- Messages will appear here -->
            </div>
            <div class="input-area">
                <input type="text" id="messageInput" placeholder="Tapez votre message s√©curis√©..." onkeypress="handleKeyPress(event)">
                <button class="btn btn-send" onclick="sendMessage()">üì§ Envoyer</button>
            </div>
        </div>

        <!-- Disconnect Button -->
        <div class="disconnect-area hidden" id="disconnectArea">
            <button class="btn btn-danger" onclick="disconnect()">‚ùå D√©connecter</button>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>Projet Acad√©mique Cybers√©curit√© - Cryptographie Appliqu√©e</p>
            <div class="crypto-info">
                <span>üîë ECDH (SECP384R1)</span>
                <span>üîê AES-256-GCM</span>
                <span>üß¨ HKDF-SHA256</span>
            </div>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
